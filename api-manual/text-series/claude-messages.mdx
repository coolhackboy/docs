---
title: "Claude Messages API"
description: "Fully compatible with Claude Messages API format"
api: "POST https://api.poyo.ai/v1/messages"
playground: "interactive"
authMethod: "key"
---

- Fully compatible with Claude Messages API format
- Supports multi-turn conversations and single queries
- Supports multimodal content including text and images

<RequestExample>
  ```bash cURL theme={null}
  curl https://api.apimart.ai/v1/messages \
    -H "x-api-key: <token>" \
    -H "anthropic-version: 2025-10-01" \
    -H "content-type: application/json" \
    -d '{
      "model": "claude-sonnet-4-5-20250929",
      "max_tokens": 1024,
      "messages": [
        {"role": "user", "content": "Hello, world"}
      ]
    }'
  ```

  ```python Python theme={null}
  import requests

  url = "https://api.apimart.ai/v1/messages"

  payload = {
      "model": "claude-sonnet-4-5-20250929",
      "max_tokens": 1024,
      "messages": [
          {"role": "user", "content": "Hello, world"}
      ]
  }

  headers = {
      "x-api-key": "<token>",
      "anthropic-version": "2025-10-01",
      "Content-Type": "application/json"
  }

  response = requests.post(url, json=payload, headers=headers)
  print(response.json())
  ```

  ```javascript JavaScript theme={null}
  const url = "https://api.apimart.ai/v1/messages";

  const payload = {
    model: "claude-sonnet-4-5-20250929",
    max_tokens: 1024,
    messages: [
      { role: "user", content: "Hello, world" }
    ]
  };

  const headers = {
    "x-api-key": "<token>",
    "anthropic-version": "2025-10-01",
    "Content-Type": "application/json"
  };

  fetch(url, {
    method: "POST",
    headers,
    body: JSON.stringify(payload)
  })
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.error("Error:", error));
  ```

  ```go Go theme={null}
  package main

  import (
      "bytes"
      "encoding/json"
      "fmt"
      "io/ioutil"
      "net/http"
  )

  func main() {
      url := "https://api.apimart.ai/v1/messages"

      payload := map[string]interface{}{
          "model": "claude-sonnet-4-5-20250929",
          "max_tokens": 1024,
          "messages": []map[string]string{
              {"role": "user", "content": "Hello, world"},
          },
      }

      jsonData, _ := json.Marshal(payload)

      req, _ := http.NewRequest("POST", url, bytes.NewBuffer(jsonData))
      req.Header.Set("x-api-key", "<token>")
      req.Header.Set("anthropic-version", "2025-10-01")
      req.Header.Set("Content-Type", "application/json")

      client := &http.Client{}
      resp, err := client.Do(req)
      if err != nil {
          panic(err)
      }
      defer resp.Body.Close()

      body, _ := ioutil.ReadAll(resp.Body)
      fmt.Println(string(body))
  }
  ```

  ```java Java theme={null}
  import java.net.http.HttpClient;
  import java.net.http.HttpRequest;
  import java.net.http.HttpResponse;
  import java.net.URI;

  public class Main {
      public static void main(String[] args) throws Exception {
          String url = "https://api.apimart.ai/v1/messages";

          String payload = """
          {
            "model": "claude-sonnet-4-5-20250929",
            "max_tokens": 1024,
            "messages": [
              {"role": "user", "content": "Hello, world"}
            ]
          }
          """;

          HttpClient client = HttpClient.newHttpClient();
          HttpRequest request = HttpRequest.newBuilder()
              .uri(URI.create(url))
              .header("x-api-key", "<token>")
              .header("anthropic-version", "2025-10-01")
              .header("Content-Type", "application/json")
              .POST(HttpRequest.BodyPublishers.ofString(payload))
              .build();

          HttpResponse<String> response = client.send(request,
              HttpResponse.BodyHandlers.ofString());

          System.out.println(response.body());
      }
  }
  ```

  ```php PHP theme={null}
  <?php

  $url = "https://api.apimart.ai/v1/messages";

  $payload = [
      "model" => "claude-sonnet-4-5-20250929",
      "max_tokens" => 1024,
      "messages" => [
          ["role" => "user", "content" => "Hello, world"]
      ]
  ];

  $ch = curl_init($url);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
  curl_setopt($ch, CURLOPT_POST, true);
  curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
  curl_setopt($ch, CURLOPT_HTTPHEADER, [
      "x-api-key: <token>",
      "anthropic-version: 2025-10-01",
      "Content-Type: application/json"
  ]);

  $response = curl_exec($ch);
  curl_close($ch);

  echo $response;
  ?>
  ```

  ```ruby Ruby theme={null}
  require 'net/http'
  require 'json'
  require 'uri'

  url = URI("https://api.apimart.ai/v1/messages")

  payload = {
    model: "claude-sonnet-4-5-20250929",
    max_tokens: 1024,
    messages: [
      { role: "user", content: "Hello, world" }
    ]
  }

  http = Net::HTTP.new(url.host, url.port)
  http.use_ssl = true

  request = Net::HTTP::Post.new(url)
  request["x-api-key"] = "<token>"
  request["anthropic-version"] = "2025-10-01"
  request["Content-Type"] = "application/json"
  request.body = payload.to_json

  response = http.request(request)
  puts response.body
  ```

  ```swift Swift theme={null}
  import Foundation

  let url = URL(string: "https://api.apimart.ai/v1/messages")!

  let payload: [String: Any] = [
      "model": "claude-sonnet-4-5-20250929",
      "max_tokens": 1024,
      "messages": [
          ["role": "user", "content": "Hello, world"]
      ]
  ]

  var request = URLRequest(url: url)
  request.httpMethod = "POST"
  request.setValue("<token>", forHTTPHeaderField: "x-api-key")
  request.setValue("2025-10-01", forHTTPHeaderField: "anthropic-version")
  request.setValue("application/json", forHTTPHeaderField: "Content-Type")
  request.httpBody = try? JSONSerialization.data(withJSONObject: payload)

  let task = URLSession.shared.dataTask(with: request) { data, response, error in
      if let error = error {
          print("Error: \(error)")
          return
      }

      if let data = data, let responseString = String(data: data, encoding: .utf8) {
          print(responseString)
      }
  }

  task.resume()
  ```

  ```csharp C# theme={null}
  using System;
  using System.Net.Http;
  using System.Text;
  using System.Threading.Tasks;

  class Program
  {
      static async Task Main(string[] args)
      {
          var url = "https://api.apimart.ai/v1/messages";

          var payload = @"{
              \"model\": \"claude-sonnet-4-5-20250929\",
              \"max_tokens\": 1024,
              \"messages\": [
                  {\"role\": \"user\", \"content\": \"Hello, world\"}
              ]
          }";

          using var client = new HttpClient();
          client.DefaultRequestHeaders.Add("x-api-key", "<token>");
          client.DefaultRequestHeaders.Add("anthropic-version", "2025-10-01");

          var content = new StringContent(payload, Encoding.UTF8, "application/json");
          var response = await client.PostAsync(url, content);
          var result = await response.Content.ReadAsStringAsync();

          Console.WriteLine(result);
      }
  }
  ```

  ```c C theme={null}
  #include <stdio.h>
  #include <curl/curl.h>

  int main(void) {
      CURL *curl;
      CURLcode res;

      curl_global_init(CURL_GLOBAL_DEFAULT);
      curl = curl_easy_init();

      if(curl) {
          const char *url = "https://api.apimart.ai/v1/messages";
          const char *payload = "{"
              "\"model\":\"claude-sonnet-4-5-20250929\","
              "\"max_tokens\":1024,"
              "\"messages\":[{\"role\":\"user\",\"content\":\"Hello, world\"}]"
          "}";

          struct curl_slist *headers = NULL;
          headers = curl_slist_append(headers, "x-api-key: <token>");
          headers = curl_slist_append(headers, "anthropic-version: 2025-10-01");
          headers = curl_slist_append(headers, "Content-Type: application/json");

          curl_easy_setopt(curl, CURLOPT_URL, url);
          curl_easy_setopt(curl, CURLOPT_POSTFIELDS, payload);
          curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);

          res = curl_easy_perform(curl);

          if(res != CURLE_OK) {
              fprintf(stderr, "curl_easy_perform() failed: %s\n",
                      curl_easy_strerror(res));
          }

          curl_slist_free_all(headers);
          curl_easy_cleanup(curl);
      }

      curl_global_cleanup();
      return 0;
  }
  ```

  ```objectivec Objective-C theme={null}
  #import <Foundation/Foundation.h>

  int main(int argc, const char * argv[]) {
      @autoreleasepool {
          NSURL *url = [NSURL URLWithString:@"https://api.apimart.ai/v1/messages"];

          NSDictionary *payload = @{
              @"model": @"claude-sonnet-4-5-20250929",
              @"max_tokens": @1024,
              @"messages": @[
                  @{ @"role": @"user", @"content": @"Hello, world" }
              ]
          };

          NSError *error;
          NSData *jsonData = [NSJSONSerialization dataWithJSONObject:payload
                                                            options:0
                                                              error:&error];

          NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
          [request setHTTPMethod:@"POST"];
          [request setValue:@"<token>" forHTTPHeaderField:@"x-api-key"];
          [request setValue:@"2025-10-01" forHTTPHeaderField:@"anthropic-version"];
          [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
          [request setHTTPBody:jsonData];

          NSURLSessionDataTask *task = [[NSURLSession sharedSession]
              dataTaskWithRequest:request
              completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
                  if (error) {
                      NSLog(@"Error: %@", error);
                      return;
                  }
                  NSString *result = [[NSString alloc] initWithData:data
                                                          encoding:NSUTF8StringEncoding];
                  NSLog(@"%@", result);
              }];

          [task resume];
          [[NSRunLoop mainRunLoop] run];
      }
      return 0;
  }
  ```

  ```ocaml OCaml theme={null}
  (* Requires cohttp and yojson libraries *)
  open Lwt
  open Cohttp
  open Cohttp_lwt_unix

  let url = "https://api.apimart.ai/v1/messages"

  let payload = {|{
    "model": "claude-sonnet-4-5-20250929",
    "max_tokens": 1024,
    "messages": [
      {"role": "user", "content": "Hello, world"}
    ]
  }|}

  let () =
    let headers = Header.init ()
      |> fun h -> Header.add h "x-api-key" "<token>"
      |> fun h -> Header.add h "anthropic-version" "2025-10-01"
      |> fun h -> Header.add h "Content-Type" "application/json"
    in
    let body = Cohttp_lwt.Body.of_string payload in

    let response = Client.post ~headers ~body (Uri.of_string url) >>= fun (resp, body) ->
      body |> Cohttp_lwt.Body.to_string >|= fun body_str ->
      print_endline body_str
    in
    Lwt_main.run response
  ```

  ```dart Dart theme={null}
  import 'dart:convert';
  import 'package:http/http.dart' as http;

  void main() async {
    final url = Uri.parse('https://api.apimart.ai/v1/messages');

    final payload = {
      'model': 'claude-sonnet-4-5-20250929',
      'max_tokens': 1024,
      'messages': [
        {'role': 'user', 'content': 'Hello, world'}
      ]
    };

    final response = await http.post(
      url,
      headers: {
        'x-api-key': '<token>',
        'anthropic-version': '2025-10-01',
        'Content-Type': 'application/json',
      },
      body: jsonEncode(payload),
    );

    print(response.body);
  }
  ```

  ```r R theme={null}
  library(httr)
  library(jsonlite)

  url <- "https://api.apimart.ai/v1/messages"

  payload <- list(
    model = "claude-sonnet-4-5-20250929",
    max_tokens = 1024,
    messages = list(
      list(
        role = "user",
        content = "Hello, world"
      )
    )
  )

  response <- POST(
    url,
    add_headers(
      `x-api-key` = "<token>",
      `anthropic-version` = "2025-10-01",
      `Content-Type` = "application/json"
    ),
    body = toJSON(payload, auto_unbox = TRUE),
    encode = "raw"
  )

  cat(content(response, "text"))
  ```
</RequestExample>

<ResponseExample>
  ```json 200 theme={null}
  {
    "code": 200,
    "data": {
      "id": "msg_013zva2CMHNLnXJNN3QKQ2EF",
      "type": "message",
      "role": "assistant",
      "content": [
        {
          "type": "text",
          "text": "Hello! I'm Claude. Nice to meet you."
        }
      ],
      "model": "claude-sonnet-4-5-20250929",
      "stop_reason": "end_turn",
      "stop_sequence": null,
      "usage": {
        "input_tokens": 10,
        "output_tokens": 13
      }
    }
  }
  ```

  ```json 400 theme={null}
  {
    "error": {
      "code": 400,
      "message": "Invalid request parameters",
      "type": "invalid_request_error"
    }
  }
  ```

  ```json 401 theme={null}
  {
    "error": {
      "code": 401,
      "message": "Authentication failed, please check your API key",
      "type": "authentication_error"
    }
  }
  ```

  ```json 429 theme={null}
  {
    "error": {
      "code": 429,
      "message": "Too many requests, please try again later",
      "type": "rate_limit_error"
    }
  }
  ```

  ```json 500 theme={null}
  {
    "error": {
      "code": 500,
      "message": "Internal server error, please try again later",
      "type": "server_error"
    }
  }
  ```
</ResponseExample>

## Authorizations

<ParamField header="x-api-key" type="string" required>
  API key for authentication

  Visit the API Key Management Page to get your API Key

  Add to the request header:

  ```
  x-api-key: YOUR_API_KEY
  ```
</ParamField>

<ParamField header="anthropic-version" type="string" required>
  API version

  Example: `2025-10-01`
</ParamField>

## Body

<ParamField body="model" type="string" required>
  Model name
</ParamField>

<ParamField body="messages" type="array" required>
  List of conversation messages

  <Expandable title="Message object structure">
    <ParamField body="role" type="enum<string>" required>
      Role type

      * `user` - User message
      * `assistant` - AI response (for multi-turn)
    </ParamField>

    <ParamField body="content" type="string" required>
      Message content

      Your question or message
    </ParamField>
  </Expandable>

  **Example:**

  ```json  theme={null}
  [{"role": "user", "content": "Hello, please introduce yourself"}]
  ```

  **Multi-turn conversation:**

  ```json  theme={null}
  [
    {"role": "user", "content": "Hello"},
    {"role": "assistant", "content": "Hi! How can I help you?"},
    {"role": "user", "content": "Tell me about AI"}
  ]
  ```
</ParamField>

<ParamField body="max_tokens" type="integer" required>
  Maximum number of tokens to generate
</ParamField>

<ParamField body="system" type="string or array">
  System prompt (string or structured blocks)

  **String example:**

  ```json  theme={null}
  "You are a professional AI assistant"
  ```

  **Structured example:**

  ```json  theme={null}
  [{"type": "text", "text": "You are a professional AI assistant"}]
  ```
</ParamField>

<ParamField body="temperature" type="number">
  Controls output randomness, range 0-1
</ParamField>

<ParamField body="top_p" type="number">
  Nucleus sampling parameter, range 0-1
</ParamField>

<ParamField body="top_k" type="integer">
  Top-k sampling parameter
</ParamField>

<ParamField body="stream" type="boolean">
  Whether to use streaming output
</ParamField>

<ParamField body="stop_sequences" type="array">
  Stop sequences where generation stops
</ParamField>

<ParamField body="metadata" type="object">
  Additional metadata such as `user_id`
</ParamField>

<ParamField body="tools" type="array">
  Tool definitions available to the model

  ```json  theme={null}
  [
    {
      "name": "get_weather",
      "description": "Get weather by city",
      "input_schema": {
        "type": "object",
        "properties": {
          "city": {"type": "string"}
        },
        "required": ["city"]
      }
    }
  ]
  ```
</ParamField>

<ParamField body="tool_choice" type="string or object">
  Controls tool usage behavior

  Examples: `"auto"`, `{"type": "tool", "name": "get_weather"}`
</ParamField>

## Response

<ResponseField name="id" type="string">
  Unique identifier for the response
</ResponseField>

<ResponseField name="type" type="string">
  Object type, fixed as `message`
</ResponseField>

<ResponseField name="role" type="string">
  Role type, fixed as `assistant`
</ResponseField>

<ResponseField name="content" type="array">
  Content blocks

  <Expandable title="Properties">
    <ResponseField name="type" type="string">
      Block type (e.g., `text`)
    </ResponseField>

    <ResponseField name="text" type="string">
      Text content
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="model" type="string">
  The actual model name used
</ResponseField>

<ResponseField name="stop_reason" type="string">
  Reason for completion
</ResponseField>

<ResponseField name="stop_sequence" type="string">
  Stop sequence that triggered completion (if any)
</ResponseField>

<ResponseField name="usage" type="object">
  Token usage statistics

  <Expandable title="Properties">
    <ResponseField name="input_tokens" type="integer">
      Number of tokens in the input messages
    </ResponseField>

    <ResponseField name="output_tokens" type="integer">
      Number of tokens in the generated content
    </ResponseField>
  </Expandable>
</ResponseField>

## Usage Examples

### Basic Conversation

```json  theme={null}
{
  "model": "claude-sonnet-4-5-20250929",
  "max_tokens": 256,
  "messages": [
    {"role": "user", "content": "Hello"}
  ]
}
```

### Streaming Response

```json  theme={null}
{
  "model": "claude-sonnet-4-5-20250929",
  "max_tokens": 256,
  "stream": true,
  "messages": [
    {"role": "user", "content": "Write a haiku about autumn"}
  ]
}
```

### Tool Use

```json  theme={null}
{
  "model": "claude-sonnet-4-5-20250929",
  "max_tokens": 256,
  "tools": [
    {
      "name": "get_weather",
      "description": "Get weather by city",
      "input_schema": {
        "type": "object",
        "properties": {
          "city": {"type": "string"}
        },
        "required": ["city"]
      }
    }
  ],
  "tool_choice": "auto",
  "messages": [
    {"role": "user", "content": "What's the weather in Tokyo?"}
  ]
}
```

### Vision Understanding

```json  theme={null}
{
  "model": "claude-sonnet-4-5-20250929",
  "max_tokens": 256,
  "messages": [
    {
      "role": "user",
      "content": [
        {"type": "text", "text": "Describe the image."},
        {
          "type": "image",
          "source": {
            "type": "base64",
            "media_type": "image/png",
            "data": "BASE64_IMAGE_DATA"
          }
        }
      ]
    }
  ]
}
```
